# Boto3

Create file `creadential.json` to store user credential

```bash
{
    "access_key": "FA81SJJDTLFHL3EUDB4G",
    "secret_key": "GuwnEpWJJrbUHjFBItTPA6FqBa5bbyXD7ZNki3xU",
    "endpoint_url": "http://192.168.0.142:8080"
}
```

# 1. Upload File

```bash
import os
import sys
from argparse import ArgumentParser
import json
import boto3

with open('credentials.json', 'r') as fd:
    credentials = json.loads(fd.read())

def main():

    parser = ArgumentParser(description='Creates a bucket')
    parser.add_argument('--bucket-name',
                        dest='bucket_name',
                        action='store',
                        required=True,
                        help='the name of the bucket to create')
    parser.add_argument('--key-name',
                        dest='key_name',
                        action='store',
                        required=True,
                        help='the objects key name')
    parser.add_argument('--file-name',
                        dest='file_name',
                        action='store',
                        required=True,
                        help='the file to upload')
    args = parser.parse_args()

    s3 = boto3.resource('s3',
                        endpoint_url=credentials['endpoint_url'],
                        aws_access_key_id=credentials['access_key'],
                        aws_secret_access_key=credentials['secret_key'])

    bucket = s3.Bucket(args.bucket_name)

    bucket.upload_file(Filename=args.file_name,
                       Key=args.key_name)

if __name__ == '__main__':
    main()
```

![Untitled](Boto3%20cd9d5ad9e42b425faa331fb63095a308/Untitled.png)

# 2. Create Bucket

```bash
import os
import sys
from argparse import ArgumentParser
import json
import boto3

with open('credentials.json', 'r') as fd:
    credentials = json.loads(fd.read())

def main():
    parser = ArgumentParser(description='Creates a bucket')
    parser.add_argument('--bucket-name',
                        dest='bucket_name',
                        action='store',
                        required=True,
                        help='the name of the bucket to create')
    args = parser.parse_args()

    s3 = boto3.resource('s3',
                        endpoint_url=credentials['endpoint_url'],
                        aws_access_key_id=credentials['access_key'],
                        aws_secret_access_key=credentials['secret_key'])

    bucket = s3.Bucket(args.bucket_name)
    bucket.create()

if __name__ == '__main__':
    main()
```

![Untitled](Boto3%20cd9d5ad9e42b425faa331fb63095a308/Untitled%201.png)

# 3. List bucket

```bash
import os
import sys
import json
import boto3

with open('credentials.json', 'r') as fd:
    credentials = json.loads(fd.read())

def main():
    s3 = boto3.client('s3',
                      endpoint_url=credentials['endpoint_url'],
                      aws_access_key_id=credentials['access_key'],
                      aws_secret_access_key=credentials['secret_key'])

    response = s3.list_buckets()
    for item in response['Buckets']:
        print(item['CreationDate'], item['Name'])

if __name__ == '__main__':
    main()                         
```

![Untitled](Boto3%20cd9d5ad9e42b425faa331fb63095a308/Untitled%202.png)

# 4. Download file

```bash
import os
import sys
from argparse import ArgumentParser
import json
import boto3

with open('credentials.json', 'r') as fd:
    credentials = json.loads(fd.read())
    
def main():
    parser = ArgumentParser(description='Creates a bucket')
    parser.add_argument('--bucket-name',
                        dest='bucket_name',
                        action='store',
                        required=True,
                        help='the name of the bucket to create')
    parser.add_argument('--key-name',
                        dest='key_name',
                        action='store',
                        required=True,
                        help='the objects key name')
    parser.add_argument('--file-name',
                        dest='file_name',
                        action='store',
                        required=True,
                        help='the file to upload')
    args = parser.parse_args()
    s3 = boto3.resource('s3',
                        endpoint_url=credentials['endpoint_url'],
                        aws_access_key_id=credentials['access_key'],
                        aws_secret_access_key=credentials['secret_key'])
    bucket = s3.Bucket(args.bucket_name)
    bucket.download_file(Filename=args.file_name,
                         Key=args.key_name)

if __name__ == '__main__':
    main()
```

![Untitled](Boto3%20cd9d5ad9e42b425faa331fb63095a308/Untitled%203.png)