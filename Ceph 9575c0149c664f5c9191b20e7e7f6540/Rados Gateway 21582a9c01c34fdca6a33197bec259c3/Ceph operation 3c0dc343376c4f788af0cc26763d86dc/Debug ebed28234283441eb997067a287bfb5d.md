# Debug

![Untitled](Debug%20ebed28234283441eb997067a287bfb5d/Untitled.png)

Add the 2 line `debug ms = 1` and `debug rgw = 20` to `ceph.conf` file, then use `systemctl` to restart the daemon.

Another way to enable debug is using the following commands. This way doesnâ€™t require to restart rgw daemon, but that way, we set the debug parameter at runtime, and when we restart again, it will not be applied.

```
$ ceph config set client.rgw debug_rgw 20/5
$ ceph config set client.rgw debug_ms 1/5
```

RGW log before enabling debug with a request

![Untitled](Debug%20ebed28234283441eb997067a287bfb5d/Untitled%201.png)

And after enabling debug output

```bash
2024-04-27T16:25:04.226+0700 7f90337ae700 20 HTTP_ACCEPT_ENCODING=identity
2024-04-27T16:25:04.226+0700 7f90337ae700 20 HTTP_AMZ_SDK_INVOCATION_ID=d4ef8c27-33f7-4b55-b732-2098c4025dd7
2024-04-27T16:25:04.226+0700 7f90337ae700 20 HTTP_AMZ_SDK_REQUEST=attempt=1
2024-04-27T16:25:04.226+0700 7f90337ae700 20 HTTP_AUTHORIZATION=AWS4-HMAC-SHA256 Credential=FA81SJJDTLFHL3EUDB4G/20240427/us-east-1/s3/aws4_request, SignedHeaders=host;x-amz-content-sha256;x-amz-date, Signature=b8153cfefe5fd0fcfe4c6203931289d2b3180fa2aee8837b0e7be417288af6ee
2024-04-27T16:25:04.226+0700 7f90337ae700 20 HTTP_HOST=192.168.0.34:8080
2024-04-27T16:25:04.226+0700 7f90337ae700 20 HTTP_USER_AGENT=Boto3/1.34.84 md/Botocore#1.34.84 ua/2.0 os/linux#5.4.0-146-generic md/arch#x86_64 lang/python#3.8.10 md/pyimpl#CPython cfg/retry-mode#legacy Botocore/1.34.84
2024-04-27T16:25:04.226+0700 7f90337ae700 20 HTTP_VERSION=1.1
2024-04-27T16:25:04.226+0700 7f90337ae700 20 HTTP_X_AMZ_CONTENT_SHA256=e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855
2024-04-27T16:25:04.226+0700 7f90337ae700 20 HTTP_X_AMZ_DATE=20240427T092504Z
2024-04-27T16:25:04.226+0700 7f90337ae700 20 QUERY_STRING=list-type=2&encoding-type=url
2024-04-27T16:25:04.226+0700 7f90337ae700 20 REMOTE_ADDR=192.168.0.118
2024-04-27T16:25:04.226+0700 7f90337ae700 20 REQUEST_METHOD=GET
2024-04-27T16:25:04.226+0700 7f90337ae700 20 REQUEST_URI=/sld-bucket?list-type=2&encoding-type=url
2024-04-27T16:25:04.226+0700 7f90337ae700 20 SCRIPT_URI=/sld-bucket
2024-04-27T16:25:04.226+0700 7f90337ae700 20 SERVER_PORT=8080
2024-04-27T16:25:04.226+0700 7f90337ae700  1 ====== starting new request req=0x7f90f43d36b0 =====
2024-04-27T16:25:04.226+0700 7f90337ae700  2 req 8757354214275700128 0.000000000s initializing for trans_id = tx0000079885f426a2c55a0-00662cc470-1ec7c-eu-east
2024-04-27T16:25:04.226+0700 7f90337ae700 10 req 8757354214275700128 0.000000000s rgw api priority: s3=8 s3website=7
2024-04-27T16:25:04.226+0700 7f90337ae700 10 req 8757354214275700128 0.000000000s host=192.168.0.34
2024-04-27T16:25:04.226+0700 7f90337ae700 20 req 8757354214275700128 0.000000000s subdomain= domain= in_hosted_domain=0 in_hosted_domain_s3website=0
2024-04-27T16:25:04.226+0700 7f90337ae700 20 req 8757354214275700128 0.000000000s final domain/bucket subdomain= domain= in_hosted_domain=0 in_hosted_domain_s3website=0 s->info.domain= s->info.request_uri=/sld-bucket
2024-04-27T16:25:04.226+0700 7f90337ae700 10 req 8757354214275700128 0.000000000s meta>> HTTP_X_AMZ_CONTENT_SHA256
2024-04-27T16:25:04.226+0700 7f90337ae700 10 req 8757354214275700128 0.000000000s meta>> HTTP_X_AMZ_DATE
2024-04-27T16:25:04.226+0700 7f90337ae700 10 req 8757354214275700128 0.000000000s x>> x-amz-content-sha256:e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855
2024-04-27T16:25:04.226+0700 7f90337ae700 10 req 8757354214275700128 0.000000000s x>> x-amz-date:20240427T092504Z
2024-04-27T16:25:04.226+0700 7f90337ae700 10 req 8757354214275700128 0.000000000s name: list-type val: 2
2024-04-27T16:25:04.226+0700 7f90337ae700 10 req 8757354214275700128 0.000000000s name: encoding-type val: url
2024-04-27T16:25:04.226+0700 7f90337ae700 20 req 8757354214275700128 0.000000000s get_handler handler=25RGWHandler_REST_Bucket_S3
2024-04-27T16:25:04.226+0700 7f90337ae700 10 req 8757354214275700128 0.000000000s handler=25RGWHandler_REST_Bucket_S3
2024-04-27T16:25:04.226+0700 7f90337ae700  2 req 8757354214275700128 0.000000000s getting op 0
2024-04-27T16:25:04.226+0700 7f90337ae700 10 req 8757354214275700128 0.000000000s s3:list_bucket scheduling with throttler client=3 cost=1
2024-04-27T16:25:04.226+0700 7f90337ae700 10 req 8757354214275700128 0.000000000s s3:list_bucket op=27RGWListBucket_ObjStore_S3v2
2024-04-27T16:25:04.226+0700 7f90337ae700  2 req 8757354214275700128 0.000000000s s3:list_bucket verifying requester
2024-04-27T16:25:04.226+0700 7f90337ae700 20 req 8757354214275700128 0.000000000s s3:list_bucket rgw::auth::StrategyRegistry::s3_main_strategy_t: trying rgw::auth::s3::AWSAuthStrategy
2024-04-27T16:25:04.226+0700 7f90337ae700 20 req 8757354214275700128 0.000000000s s3:list_bucket rgw::auth::s3::AWSAuthStrategy: trying rgw::auth::s3::S3AnonymousEngine
2024-04-27T16:25:04.226+0700 7f90337ae700 20 req 8757354214275700128 0.000000000s s3:list_bucket rgw::auth::s3::S3AnonymousEngine denied with reason=-1
2024-04-27T16:25:04.226+0700 7f90337ae700 20 req 8757354214275700128 0.000000000s s3:list_bucket rgw::auth::s3::AWSAuthStrategy: trying rgw::auth::s3::LocalEngine
2024-04-27T16:25:04.226+0700 7f90337ae700 10 req 8757354214275700128 0.000000000s v4 signature format = b8153cfefe5fd0fcfe4c6203931289d2b3180fa2aee8837b0e7be417288af6ee
2024-04-27T16:25:04.226+0700 7f90337ae700 10 req 8757354214275700128 0.000000000s v4 credential format = FA81SJJDTLFHL3EUDB4G/20240427/us-east-1/s3/aws4_request
2024-04-27T16:25:04.226+0700 7f90337ae700 10 req 8757354214275700128 0.000000000s access key id = FA81SJJDTLFHL3EUDB4G
2024-04-27T16:25:04.226+0700 7f90337ae700 10 req 8757354214275700128 0.000000000s credential scope = 20240427/us-east-1/s3/aws4_request
2024-04-27T16:25:04.226+0700 7f90337ae700 10 req 8757354214275700128 0.000000000s canonical headers format = host:192.168.0.34:8080
x-amz-content-sha256:e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855
x-amz-date:20240427T092504Z

2024-04-27T16:25:04.226+0700 7f90337ae700 10 req 8757354214275700128 0.000000000s payload request hash = e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855
2024-04-27T16:25:04.226+0700 7f90337ae700 10 req 8757354214275700128 0.000000000s canonical request = GET
/sld-bucket
encoding-type=url&list-type=2
host:192.168.0.34:8080
x-amz-content-sha256:e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855
x-amz-date:20240427T092504Z

host;x-amz-content-sha256;x-amz-date
e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855
2024-04-27T16:25:04.226+0700 7f90337ae700 10 req 8757354214275700128 0.000000000s canonical request hash = 6f080bf4d8ad711afb0589d26dc1f2442acbc70edda3212fef69e744427f63f0
2024-04-27T16:25:04.226+0700 7f90337ae700 10 req 8757354214275700128 0.000000000s string to sign = AWS4-HMAC-SHA256
20240427T092504Z
20240427/us-east-1/s3/aws4_request
6f080bf4d8ad711afb0589d26dc1f2442acbc70edda3212fef69e744427f63f0
2024-04-27T16:25:04.226+0700 7f90337ae700 10 req 8757354214275700128 0.000000000s date_k    = c463ab4bfa7c90939acdf5923a5bc6dd6aed4f77aa45f417e185e217ef9f3578
2024-04-27T16:25:04.226+0700 7f90337ae700 10 req 8757354214275700128 0.000000000s region_k  = fd2dea024d5f33420db96e5cbafa7f5628b3cec352a497bed82bb1196eaf93a7
2024-04-27T16:25:04.226+0700 7f90337ae700 10 req 8757354214275700128 0.000000000s service_k = 77d44351f2da9a62c4793baf6b3a52b4520a306070d79ef207cf7d8bbb305a82
2024-04-27T16:25:04.226+0700 7f90337ae700 10 req 8757354214275700128 0.000000000s signing_k = e8cdfe5c05249d9e79833c8d0313acfdbad77d28700bd756bc1de9d2b7d2b348
2024-04-27T16:25:04.226+0700 7f90337ae700 10 req 8757354214275700128 0.000000000s generated signature = b8153cfefe5fd0fcfe4c6203931289d2b3180fa2aee8837b0e7be417288af6ee
2024-04-27T16:25:04.226+0700 7f90337ae700 15 req 8757354214275700128 0.000000000s s3:list_bucket string_to_sign=AWS4-HMAC-SHA256
20240427T092504Z
20240427/us-east-1/s3/aws4_request
6f080bf4d8ad711afb0589d26dc1f2442acbc70edda3212fef69e744427f63f0
2024-04-27T16:25:04.226+0700 7f90337ae700 15 req 8757354214275700128 0.000000000s s3:list_bucket server signature=b8153cfefe5fd0fcfe4c6203931289d2b3180fa2aee8837b0e7be417288af6ee
2024-04-27T16:25:04.226+0700 7f90337ae700 15 req 8757354214275700128 0.000000000s s3:list_bucket client signature=b8153cfefe5fd0fcfe4c6203931289d2b3180fa2aee8837b0e7be417288af6ee
2024-04-27T16:25:04.226+0700 7f90337ae700 15 req 8757354214275700128 0.000000000s s3:list_bucket compare=0
2024-04-27T16:25:04.226+0700 7f90337ae700 20 req 8757354214275700128 0.000000000s s3:list_bucket rgw::auth::s3::LocalEngine granted access
2024-04-27T16:25:04.226+0700 7f90337ae700 20 req 8757354214275700128 0.000000000s s3:list_bucket rgw::auth::s3::AWSAuthStrategy granted access
2024-04-27T16:25:04.226+0700 7f90337ae700  2 req 8757354214275700128 0.000000000s s3:list_bucket normalizing buckets and tenants
2024-04-27T16:25:04.226+0700 7f90337ae700 10 req 8757354214275700128 0.000000000s s->object=<NULL> s->bucket=sld-bucket
2024-04-27T16:25:04.226+0700 7f90337ae700  2 req 8757354214275700128 0.000000000s s3:list_bucket init permissions
2024-04-27T16:25:04.226+0700 7f90337ae700 20 req 8757354214275700128 0.000000000s s3:list_bucket get_system_obj_state: rctx=0x7f90f43d2070 obj=eu-east.rgw.meta:root:sld-bucket state=0x7f90bc015b20 s->prefetch_data=0
2024-04-27T16:25:04.226+0700 7f90337ae700 10 req 8757354214275700128 0.000000000s s3:list_bucket cache get: name=eu-east.rgw.meta+root+sld-bucket : hit (requested=0x16, cached=0x17)
2024-04-27T16:25:04.226+0700 7f90337ae700 20 req 8757354214275700128 0.000000000s s3:list_bucket get_system_obj_state: s->obj_tag was set empty
2024-04-27T16:25:04.226+0700 7f90337ae700 10 req 8757354214275700128 0.000000000s s3:list_bucket cache get: name=eu-east.rgw.meta+root+sld-bucket : hit (requested=0x11, cached=0x17)
2024-04-27T16:25:04.226+0700 7f90337ae700 15 req 8757354214275700128 0.000000000s s3:list_bucket decode_policy Read AccessControlPolicy<AccessControlPolicy xmlns="http://s3.amazonaws.com/doc/2006-03-01/"><Owner><ID>johndoe</ID><DisplayName>John Doe</DisplayName></Owner><AccessControlList><Grant><Grantee xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="CanonicalUser"><ID>johndoe</ID><DisplayName>John Doe</DisplayName></Grantee><Permission>FULL_CONTROL</Permission></Grant></AccessControlList></AccessControlPolicy>
2024-04-27T16:25:04.226+0700 7f90337ae700 20 req 8757354214275700128 0.000000000s s3:list_bucket get_system_obj_state: rctx=0x7f90f43d1b78 obj=eu-east.rgw.meta:users.uid:johndoe state=0x7f90bc015b20 s->prefetch_data=0
2024-04-27T16:25:04.226+0700 7f90337ae700 10 req 8757354214275700128 0.000000000s s3:list_bucket cache get: name=eu-east.rgw.meta+users.uid+johndoe : hit (requested=0x6, cached=0x17)
2024-04-27T16:25:04.226+0700 7f90337ae700 20 req 8757354214275700128 0.000000000s s3:list_bucket get_system_obj_state: s->obj_tag was set empty
2024-04-27T16:25:04.226+0700 7f90337ae700 20 req 8757354214275700128 0.000000000s s3:list_bucket Read xattr: user.rgw.idtag
2024-04-27T16:25:04.226+0700 7f90337ae700 10 req 8757354214275700128 0.000000000s s3:list_bucket cache get: name=eu-east.rgw.meta+users.uid+johndoe : hit (requested=0x3, cached=0x17)
2024-04-27T16:25:04.226+0700 7f90337ae700  2 req 8757354214275700128 0.000000000s s3:list_bucket recalculating target
2024-04-27T16:25:04.226+0700 7f90337ae700  2 req 8757354214275700128 0.000000000s s3:list_bucket reading permissions
2024-04-27T16:25:04.226+0700 7f90337ae700  2 req 8757354214275700128 0.000000000s s3:list_bucket init op
2024-04-27T16:25:04.226+0700 7f90337ae700  2 req 8757354214275700128 0.000000000s s3:list_bucket verifying op mask
2024-04-27T16:25:04.226+0700 7f90337ae700 20 req 8757354214275700128 0.000000000s s3:list_bucket required_mask= 1 user.op_mask=7
2024-04-27T16:25:04.226+0700 7f90337ae700  2 req 8757354214275700128 0.000000000s s3:list_bucket verifying op permissions
2024-04-27T16:25:04.226+0700 7f90337ae700 20 req 8757354214275700128 0.000000000s s3:list_bucket -- Getting permissions begin with perm_mask=49
2024-04-27T16:25:04.226+0700 7f90337ae700  5 req 8757354214275700128 0.000000000s s3:list_bucket Searching permissions for identity=rgw::auth::SysReqApplier -> rgw::auth::LocalApplier(acct_user=johndoe, acct_name=John Doe, subuser=, perm_mask=15, is_admin=0) mask=49
2024-04-27T16:25:04.226+0700 7f90337ae700  5 req 8757354214275700128 0.000000000s s3:list_bucket Searching permissions for uid=johndoe
2024-04-27T16:25:04.226+0700 7f90337ae700  5 req 8757354214275700128 0.000000000s s3:list_bucket Found permission: 15
2024-04-27T16:25:04.226+0700 7f90337ae700  5 req 8757354214275700128 0.000000000s s3:list_bucket Searching permissions for group=1 mask=49
2024-04-27T16:25:04.226+0700 7f90337ae700  5 req 8757354214275700128 0.000000000s s3:list_bucket Permissions for group not found
2024-04-27T16:25:04.226+0700 7f90337ae700  5 req 8757354214275700128 0.000000000s s3:list_bucket Searching permissions for group=2 mask=49
2024-04-27T16:25:04.226+0700 7f90337ae700  5 req 8757354214275700128 0.000000000s s3:list_bucket Permissions for group not found
2024-04-27T16:25:04.226+0700 7f90337ae700  5 req 8757354214275700128 0.000000000s s3:list_bucket -- Getting permissions done for identity=rgw::auth::SysReqApplier -> rgw::auth::LocalApplier(acct_user=johndoe, acct_name=John Doe, subuser=, perm_mask=15, is_admin=0), owner=johndoe, perm=1
2024-04-27T16:25:04.226+0700 7f90337ae700 10 req 8757354214275700128 0.000000000s s3:list_bucket  identity=rgw::auth::SysReqApplier -> rgw::auth::LocalApplier(acct_user=johndoe, acct_name=John Doe, subuser=, perm_mask=15, is_admin=0) requested perm (type)=1, policy perm=1, user_perm_mask=1, acl perm=1
2024-04-27T16:25:04.226+0700 7f90337ae700  2 req 8757354214275700128 0.000000000s s3:list_bucket verifying op params
2024-04-27T16:25:04.226+0700 7f90337ae700  2 req 8757354214275700128 0.000000000s s3:list_bucket pre-executing
2024-04-27T16:25:04.226+0700 7f90337ae700  2 req 8757354214275700128 0.000000000s s3:list_bucket executing
2024-04-27T16:25:04.226+0700 7f90337ae700 20 req 8757354214275700128 0.000000000s s3:list_bucket RGWRados::Bucket::List::list_objects_ordered starting attempt 1
2024-04-27T16:25:04.226+0700 7f90337ae700 10 req 8757354214275700128 0.000000000s s3:list_bucket RGWRados::cls_bucket_list_ordered: :sld-bucket[8261a649-895b-4e87-8f42-22cf27c49304.44207.1]) start_after="[]", prefix="" num_entries=1001, list_versions=0, expansion_factor=1
2024-04-27T16:25:04.226+0700 7f90337ae700 10 req 8757354214275700128 0.000000000s s3:list_bucket RGWRados::cls_bucket_list_ordered request from each of 11 shard(s) for 112 entries to get 1001 total entries
2024-04-27T16:25:04.226+0700 7f90337ae700 20 req 8757354214275700128 0.000000000s s3:list_bucket RGWRados::cls_bucket_list_ordered currently processing helloo-1.txt from shard 7
2024-04-27T16:25:04.226+0700 7f90337ae700 10 req 8757354214275700128 0.000000000s s3:list_bucket RGWRados::cls_bucket_list_ordered: got helloo-1.txt[]
2024-04-27T16:25:04.226+0700 7f90337ae700 20 req 8757354214275700128 0.000000000s s3:list_bucket RGWRados::cls_bucket_list_ordered currently processing helloo.txt from shard 9
2024-04-27T16:25:04.226+0700 7f90337ae700 10 req 8757354214275700128 0.000000000s s3:list_bucket RGWRados::cls_bucket_list_ordered: got helloo.txt[]
2024-04-27T16:25:04.226+0700 7f90337ae700 20 req 8757354214275700128 0.000000000s s3:list_bucket RGWRados::cls_bucket_list_ordered: returning, count=2, is_truncated=0
2024-04-27T16:25:04.226+0700 7f90337ae700 20 req 8757354214275700128 0.000000000s s3:list_bucket RGWRados::cls_bucket_list_ordered: returning, last_entry=helloo.txt
2024-04-27T16:25:04.226+0700 7f90337ae700 20 req 8757354214275700128 0.000000000s s3:list_bucket RGWRados::Bucket::List::list_objects_ordered considering entry helloo-1.txt
2024-04-27T16:25:04.226+0700 7f90337ae700 20 req 8757354214275700128 0.000000000s s3:list_bucket RGWRados::Bucket::List::list_objects_ordered adding entry helloo-1.txt to result
2024-04-27T16:25:04.226+0700 7f90337ae700 20 req 8757354214275700128 0.000000000s s3:list_bucket RGWRados::Bucket::List::list_objects_ordered considering entry helloo.txt
2024-04-27T16:25:04.226+0700 7f90337ae700 20 req 8757354214275700128 0.000000000s s3:list_bucket RGWRados::Bucket::List::list_objects_ordered adding entry helloo.txt to result
2024-04-27T16:25:04.226+0700 7f90337ae700 20 req 8757354214275700128 0.000000000s s3:list_bucket RGWRados::Bucket::List::list_objects_ordered INFO end of outer loop, truncated=0, count=2, attempt=1
2024-04-27T16:25:04.226+0700 7f90337ae700  2 req 8757354214275700128 0.000000000s s3:list_bucket completing
2024-04-27T16:25:04.226+0700 7f90497da700  2 req 8757354214275700128 0.000000000s s3:list_bucket op status=0
2024-04-27T16:25:04.226+0700 7f90497da700  2 req 8757354214275700128 0.000000000s s3:list_bucket http status=200
2024-04-27T16:25:04.226+0700 7f90497da700  1 ====== req done req=0x7f90f43d36b0 op status=0 http_status=200 latency=0.000000000s ======
```